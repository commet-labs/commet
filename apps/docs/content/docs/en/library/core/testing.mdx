---
title: Testing
description: Test safely with sandbox environment
---

# Testing

Use sandbox environment to test safely before production.

## Test Cards

Use these test cards in sandbox:

**Successful payments:**

| Card | Brand |
|------|-------|
| `4242 4242 4242 4242` | Visa |
| `5555 5555 5555 4444` | Mastercard |

Use any future expiry date and any 3-digit CVC.

**Failed payments:**

| Card | Scenario |
|------|----------|
| `4000 0000 0000 9995` | Insufficient funds |
| `4000 0000 0000 9987` | Lost card |
| `4000 0000 0000 9979` | Stolen card |

**3D Secure:**

| Card | Description |
|------|-------------|
| `4000 0025 0000 3155` | Requires authentication |

## Sandbox Environment

Sandbox is the default environment with completely isolated data:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_SANDBOX_KEY!,
  environment: 'sandbox'  // Default
})

// All operations use sandbox.commet.co
await commet.customers.create({
  legalName: 'Test Customer',
  currency: 'USD'
})
```

**Sandbox features:**
- Separate database from production
- Real API behavior
- Free operations
- Safe experimentation

## Test Workflow

```typescript
// 1. Create test customer
const customer = await commet.customers.create({
  legalName: 'Test Company',
  currency: 'USD'
})

// 2. Create subscription
const subscription = await commet.subscriptions.create({
  productId: 'prd_test_123',
  customerId: customer.data.id
})

// 3. Send usage events
await commet.usage.create({
  eventType: 'api_call',
  customerId: customer.data.id,
  idempotencyKey: `test_${Date.now()}`
})

// 4. Verify
const events = await commet.usage.list({
  customerId: customer.data.id
})
console.log('Events:', events.data.length)
```

## Unique Identifiers

Use unique IDs to avoid conflicts:

```typescript
const testId = `test_${Date.now()}`

await commet.customers.create({
  legalName: `Test Customer ${testId}`,
  externalId: testId,
  currency: 'USD'
})
```

## Test Idempotency

```typescript
const eventId = `test_${Date.now()}`

// Send twice with same idempotencyKey
await commet.usage.create({
  eventType: 'api_call',
  customerId: 'cus_123',
  idempotencyKey: eventId
})

// Second call won't create duplicate
await commet.usage.create({
  eventType: 'api_call',
  customerId: 'cus_123',
  idempotencyKey: eventId  // Same ID
})
```

## Switch to Production

```typescript
// Sandbox (testing)
const sandbox = new Commet({
  apiKey: process.env.COMMET_SANDBOX_KEY!,
  environment: 'sandbox'
})

// Production (live)
const production = new Commet({
  apiKey: process.env.COMMET_PRODUCTION_KEY!,
  environment: 'production'
})
```

Get production API key from the [dashboard](https://commet.co/settings/api-keys).
