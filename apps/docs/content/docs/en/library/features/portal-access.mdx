---
title: Customer Portal
description: Generate secure portal URLs for customers
---

## Get Portal URL

### External ID (Recommended)

```typescript
const portal = await commet.portal.getUrl({
  externalId: 'user_123'
})

console.log(portal.data.portalUrl)
```

### Customer ID

```typescript
const portal = await commet.portal.getUrl({
  customerId: 'cus_abc123'
})
```

### Email

```typescript
const portal = await commet.portal.getUrl({
  email: 'customer@example.com'
})
```

## Next.js Integration

Use `@commet/next` for a one-line portal redirect:

```typescript title="app/api/commet/portal/route.ts"
import { CustomerPortal } from '@commet/next'
import { auth } from '@/lib/auth'

export const GET = CustomerPortal({
  apiKey: process.env.COMMET_API_KEY!,
  environment: 'sandbox',
  getCustomerId: async (req) => {
    const session = await auth.api.getSession({ headers: req.headers })
    return session?.user.id ?? null
  },
})
```

Link to the portal:

```tsx
<a href="/api/commet/portal">Manage Billing</a>
```

## Manual Integration

### Redirect to Portal

```typescript
export async function GET(request: Request) {
  const userId = getUserFromSession(request)

  const portal = await commet.portal.getUrl({
    externalId: userId
  })

  if (portal.data) {
    return Response.redirect(portal.data.portalUrl)
  }
}
```

### Express.js

```typescript
app.post('/api/portal', async (req, res) => {
  const portal = await commet.portal.getUrl({
    externalId: req.body.customerId
  })

  res.json({ url: portal.data.portalUrl })
})
```

## Response

```typescript
{
  success: true,
  data: {
    portalUrl: "https://app.commet.co/acme/portal/overview?token=..."
  }
}
```

## Related Resources

- [Next.js Setup](/docs/library/installation/nextjs) - Full Next.js integration guide
- [Customers](/docs/library/features/customers) - Manage customer data
- [Subscriptions](/docs/library/features/subscriptions) - View what customers see in the portal
