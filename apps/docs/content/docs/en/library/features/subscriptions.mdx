---
title: Subscriptions
description: Simple subscription management with automatic configuration
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

# Subscriptions

Create subscriptions with just a product ID and customer ID. The system automatically handles pricing, quantities, and billing configuration based on your product setup.

<Callout type="info">
**Prerequisites:** Initialize your Commet client with a valid API key.
</Callout>

## Basic Usage

Create a subscription with minimal information:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})

console.log('Subscription created:', subscription.data.id)
```

<Callout type="info">
**Auto-configuration**: Backend automatically selects the default list price, configures quantities based on product type, and sets billing day to today.
</Callout>

<Callout type="success">
**Testing subscriptions?** Use the sandbox environment and [Stripe test cards](/docs/library/core/testing#stripe-test-cards) to test checkout flows safely.
</Callout>

### Using External IDs

Reference customers with your own IDs:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  externalId: 'stripe_cus_abc123' // Your internal customer ID
})
```

## Product Types

The SDK supports three product types with smart defaults:

<Tabs items={['Fixed', 'Usage-Based', 'Seat-Based']}>
<Tab value="Fixed">
```typescript
// Fixed quantity product (licenses, plans)
const subscription = await commet.subscriptions.create({
  productId: 'prod_enterprise_plan',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
// Backend sets: fixedQuantity = 1

// Custom quantity
const subscription = await commet.subscriptions.create({
  productId: 'prod_api_platform',
  externalId: 'my-customer-123',
  quantity: 5 // 5 units
})
```
</Tab>
<Tab value="Usage-Based">
```typescript
// Usage-based product (API calls, emails)
const subscription = await commet.subscriptions.create({
  productId: 'prod_api_calls',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
// Backend uses usageMetricId from product

// Then track usage events
await commet.usage.create({
  eventType: 'api_call',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
```
</Tab>
<Tab value="Seat-Based">
```typescript
// Seat-based product (user licenses)
const subscription = await commet.subscriptions.create({
  productId: 'prod_saas_licenses',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  initialSeats: 10 // Start with 10 seats
})
// Backend uses seatTypeId from product

// Then manage seats
await commet.seats.add({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  seatType: 'editor',
  count: 5
})
```
</Tab>
</Tabs>

<Callout type="info">
**No quantity needed for usage-based**: Quantity comes from usage events. For seat-based, `initialSeats` defaults to 0 if not specified.
</Callout>

## Subscription Operations

### Create with Options

Customize subscription creation:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  name: 'Custom Subscription Name',
  startDate: '2025-01-15T00:00:00Z',
  status: 'active', // Generate invoice immediately
  quantity: 5 // For fixed products
})
```

<Callout type="info">
**Default status is active**: Subscriptions generate invoices immediately unless status is set to `draft`.
</Callout>

### Retrieve Subscription

Get subscription details:

```typescript
const subscription = await commet.subscriptions.retrieve('sub_A1b2C3d4E5f6G7h8I9j0K1l2')

console.log('Subscription:', subscription.data.name)
console.log('Status:', subscription.data.status)
```

### List Subscriptions

Filter subscriptions by customer or status:

```typescript
// By customer ID
const subscriptions = await commet.subscriptions.list({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  status: 'active'
})

// By external ID
const subscriptions = await commet.subscriptions.list({
  externalId: 'stripe_cus_abc123'
})

console.log(`Found ${subscriptions.data.length} subscriptions`)
```

### Cancel Subscription

Cancel an active subscription:

```typescript
const result = await commet.subscriptions.cancel('sub_A1b2C3d4E5f6G7h8I9j0K1l2')

console.log('Subscription canceled:', result.data.status)
```

## Advanced Usage

### Draft Subscriptions

Create subscription for review before activation:

```typescript
const draft = await commet.subscriptions.create({
  productId: 'prod_enterprise',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  quantity: 10,
  status: 'draft' // No invoice generated
})

// Review in platform UI, then activate manually
```

<Callout type="warn">
**Draft subscriptions**: Don't generate invoices until manually activated in the platform or updated via API.
</Callout>

### Custom Start Date

Schedule subscriptions for future billing:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_monthly_plan',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  startDate: '2025-02-01T00:00:00Z', // Future date
  status: 'active'
})

// Billing day set to: February 1st
console.log('Billing day:', subscription.data.billingDayOfMonth) // 1
```

## Complete Examples

### SaaS Platform (Seats)

```typescript
// Create subscription with initial seats
const sub = await commet.subscriptions.create({
  productId: 'prod_saas_platform',
  externalId: 'startup-xyz',
  initialSeats: 5,
  name: 'Startup XYZ - Growth Plan',
  status: 'active'
})

// User adds team members
await commet.seats.add({
  externalId: 'startup-xyz',
  seatType: 'editor',
  count: 3
})

// Check current balance
const balance = await commet.seats.getBalance({
  externalId: 'startup-xyz',
  seatType: 'editor'
})
console.log('Total seats:', balance.data.current) // 8
```

### API Platform (Usage)

```typescript
// Create subscription
await commet.subscriptions.create({
  productId: 'prod_api_platform',
  customerId: 'cus_fintech_app'
})

// Track API usage
await commet.usage.createBatch({
  events: [
    {
      eventType: 'api_call',
      customerId: 'cus_fintech_app',
      properties: [
        { property: 'endpoint', value: '/api/transactions' },
        { property: 'method', value: 'POST' }
      ]
    }
  ]
})
```

### Enterprise Deal (Fixed)

```typescript
// Create as draft for sales review
const draft = await commet.subscriptions.create({
  productId: 'prod_enterprise',
  customerId: 'cus_big_corp',
  quantity: 100,
  name: 'Big Corp - Custom Enterprise Deal',
  status: 'draft'
})

// After approval, activate in platform UI
```

## Error Handling

Handle common errors gracefully:

```typescript
try {
  await commet.subscriptions.create({
    productId: 'prod_xxx',
    customerId: 'cus_xxx'
  })
} catch (error) {
  if (error.statusCode === 404) {
    console.error('Product or customer not found')
  } else if (error.statusCode === 400) {
    console.error('Product has no list prices configured')
  }
}
```

## Best Practices

<Callout type="info">
**Use External IDs**: Connect with your existing system for simpler integration.
</Callout>

<Callout type="info">
**Default to Active**: Use `status: "active"` unless manual approval is required.
</Callout>

<Callout type="info">
**Auto-configuration**: Let the backend handle quantity sources - don't overthink the setup.
</Callout>

<Callout type="info">
**Seats Start at Zero**: For seat-based products, set `initialSeats: 0` and add seats as users sign up.
</Callout>

## Related Resources

- [Usage Events](/docs/en/library/features/usage-events) - Track consumption for usage-based billing
- [Seat Management](/docs/en/library/features/seat-management) - Manage per-seat licensing
- [Customers](/docs/en/library/features/customers) - Create and manage customers
