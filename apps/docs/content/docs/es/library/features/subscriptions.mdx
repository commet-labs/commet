---
title: Suscripciones
description: Crea y gestiona suscripciones con múltiples productos
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

<Callout type="info">
**Prerrequisitos:** Inicializa tu cliente Commet con una clave API válida.
</Callout>

<Callout type="success">
**¿Probando suscripciones?** Usa el entorno sandbox y las [tarjetas de prueba de Stripe](/es/docs/library/core/testing#tarjetas-de-prueba-de-stripe) para probar flujos de checkout de forma segura.
</Callout>

## Crear Suscripción

Crea una suscripción con uno o más productos:

```typescript
const subscription = await commet.subscriptions.create({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  items: [
    { priceId: 'price_tasks_free', quantity: 1 }
  ]
})

console.log('Suscripción creada:', subscription.data.id)
```

### Múltiples Productos

Agrupa múltiples productos en una sola suscripción:

```typescript
const subscription = await commet.subscriptions.create({
  externalId: 'org_123',
  items: [
    { priceId: 'price_tasks_pro', quantity: 1 },
    { priceId: 'price_usage_pro' },
    { priceId: 'price_seats_pro', initialSeats: 5 }
  ],
  status: 'active'
})
```

### Tipos de Productos

<Tabs items={['Fijo', 'Por Uso', 'Por Asientos']}>
<Tab value="Fijo">
```typescript
const subscription = await commet.subscriptions.create({
  customerId: 'cus_xxx',
  items: [
    { priceId: 'price_fixed_plan', quantity: 1 }
  ]
})
```
</Tab>
<Tab value="Por Uso">
```typescript
const subscription = await commet.subscriptions.create({
  customerId: 'cus_xxx',
  items: [
    { priceId: 'price_api_calls' }
  ]
})

// Rastrea uso
await commet.usage.create({
  eventType: 'api_call',
  customerId: 'cus_xxx',
  idempotencyKey: `evt_${Date.now()}`
})
```
</Tab>
<Tab value="Por Asientos">
```typescript
const subscription = await commet.subscriptions.create({
  customerId: 'cus_xxx',
  items: [
    { priceId: 'price_user_licenses', initialSeats: 10 }
  ]
})

// Gestiona asientos
await commet.seats.add({
  customerId: 'cus_xxx',
  seatType: 'editor',
  count: 5
})
```
</Tab>
</Tabs>

## Opciones

### Suscripción Borrador

Crea suscripción para revisión antes de activación:

```typescript
const draft = await commet.subscriptions.create({
  customerId: 'cus_xxx',
  items: [
    { priceId: 'price_enterprise', quantity: 100 }
  ],
  status: 'draft'
})
```

<Callout type="info">
**Suscripciones borrador** no generan facturas hasta ser activadas manualmente en la plataforma.
</Callout>

### Fecha de Inicio Personalizada

Programa suscripciones para facturación futura:

```typescript
const subscription = await commet.subscriptions.create({
  customerId: 'cus_xxx',
  items: [
    { priceId: 'price_monthly', quantity: 1 }
  ],
  startDate: '2025-02-01T00:00:00Z',
  status: 'active'
})
```

### Suscripción con Nombre

```typescript
const subscription = await commet.subscriptions.create({
  externalId: 'startup-xyz',
  name: 'Startup XYZ - Plan Growth',
  items: [
    { priceId: 'price_growth', quantity: 1 }
  ]
})
```

## Operaciones Básicas

```typescript
// Recuperar suscripción
const subscription = await commet.subscriptions.retrieve('sub_A1b2C3d4E5f6G7h8I9j0K1l2')

// Listar suscripciones
const subscriptions = await commet.subscriptions.list({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  status: 'active'
})

// Listar por ID externo
const subscriptions = await commet.subscriptions.list({
  externalId: 'org_123'
})

// Cancelar suscripción
await commet.subscriptions.cancel('sub_A1b2C3d4E5f6G7h8I9j0K1l2')
```

## Ejemplo Completo

```typescript
// Crear suscripción con múltiples productos
const sub = await commet.subscriptions.create({
  externalId: 'startup-xyz',
  name: 'Startup XYZ - Plan Growth',
  items: [
    { priceId: 'price_base_plan', quantity: 1 },
    { priceId: 'price_api_usage' },
    { priceId: 'price_user_seats', initialSeats: 5 }
  ],
  status: 'active'
})

// Rastrear uso de API
await commet.usage.create({
  eventType: 'api_call',
  externalId: 'startup-xyz',
  idempotencyKey: `evt_${Date.now()}`
})

// Agregar miembros del equipo
await commet.seats.add({
  externalId: 'startup-xyz',
  seatType: 'editor',
  count: 3
})

// Verificar balance de asientos
const balance = await commet.seats.getBalance({
  externalId: 'startup-xyz',
  seatType: 'editor'
})
console.log('Total asientos:', balance.data.current) // 8
```

## Recursos Relacionados

- [Eventos de Uso](/es/docs/library/features/usage-events) - Rastrea consumo para facturación por uso
- [Gestión de Asientos](/es/docs/library/features/seat-management) - Gestiona licencias por asiento
- [Clientes](/es/docs/library/features/customers) - Crea y gestiona clientes
