---
title: Suscripciones
description: Gestión simple de suscripciones con configuración automática
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

# Suscripciones

Crea suscripciones con solo un ID de producto y un ID de cliente. El sistema maneja automáticamente precios, cantidades y configuración de facturación según tu producto.

<Callout type="info">
**Prerrequisitos:** Inicializa tu cliente Commet con una clave API válida.
</Callout>

## Uso Básico

Crea una suscripción con información mínima:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})

console.log('Suscripción creada:', subscription.data.id)
```

<Callout type="info">
**Auto-configuración**: El backend selecciona automáticamente el precio de lista por defecto, configura cantidades según el tipo de producto, y establece el día de facturación a hoy.
</Callout>

### Usando IDs Externos

Referencia clientes con tus propios IDs:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  externalId: 'stripe_cus_abc123' // Tu ID interno de cliente
})
```

## Tipos de Productos

El SDK soporta tres tipos de productos con defaults inteligentes:

<Tabs items={['Fijo', 'Por Uso', 'Por Asientos']}>
<Tab value="Fijo">
```typescript
// Producto de cantidad fija (licencias, planes)
const subscription = await commet.subscriptions.create({
  productId: 'prod_enterprise_plan',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
// Backend establece: fixedQuantity = 1

// Cantidad personalizada
const subscription = await commet.subscriptions.create({
  productId: 'prod_api_platform',
  externalId: 'my-customer-123',
  quantity: 5 // 5 unidades
})
```
</Tab>
<Tab value="Por Uso">
```typescript
// Producto basado en uso (llamadas API, emails)
const subscription = await commet.subscriptions.create({
  productId: 'prod_api_calls',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
// Backend usa usageMetricId del producto

// Luego rastrea eventos de uso
await commet.usage.create({
  eventType: 'api_call',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2'
})
```
</Tab>
<Tab value="Por Asientos">
```typescript
// Producto basado en asientos (licencias de usuario)
const subscription = await commet.subscriptions.create({
  productId: 'prod_saas_licenses',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  initialSeats: 10 // Comienza con 10 asientos
})
// Backend usa seatTypeId del producto

// Luego gestiona asientos
await commet.seats.add({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  seatType: 'editor',
  count: 5
})
```
</Tab>
</Tabs>

<Callout type="info">
**No se necesita cantidad para productos por uso**: La cantidad viene de eventos de uso. Para productos por asientos, `initialSeats` es 0 por defecto si no se especifica.
</Callout>

## Operaciones de Suscripción

### Crear con Opciones

Personaliza la creación de suscripción:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_A1b2C3d4E5f6G7h8I9j0K1l2',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  name: 'Nombre Personalizado de Suscripción',
  startDate: '2025-01-15T00:00:00Z',
  status: 'active', // Genera factura inmediatamente
  quantity: 5 // Para productos fijos
})
```

<Callout type="info">
**Status por defecto es active**: Las suscripciones generan facturas inmediatamente a menos que el status sea `draft`.
</Callout>

### Recuperar Suscripción

Obtén detalles de la suscripción:

```typescript
const subscription = await commet.subscriptions.retrieve('sub_A1b2C3d4E5f6G7h8I9j0K1l2')

console.log('Suscripción:', subscription.data.name)
console.log('Estado:', subscription.data.status)
```

### Listar Suscripciones

Filtra suscripciones por cliente o estado:

```typescript
// Por ID de cliente
const subscriptions = await commet.subscriptions.list({
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  status: 'active'
})

// Por ID externo
const subscriptions = await commet.subscriptions.list({
  externalId: 'stripe_cus_abc123'
})

console.log(`Encontradas ${subscriptions.data.length} suscripciones`)
```

### Cancelar Suscripción

Cancela una suscripción activa:

```typescript
const result = await commet.subscriptions.cancel('sub_A1b2C3d4E5f6G7h8I9j0K1l2')

console.log('Suscripción cancelada:', result.data.status)
```

## Uso Avanzado

### Suscripciones Borrador

Crea suscripción para revisión antes de activación:

```typescript
const draft = await commet.subscriptions.create({
  productId: 'prod_enterprise',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  quantity: 10,
  status: 'draft' // No genera factura
})

// Revisa en la UI de la plataforma, luego activa manualmente
```

<Callout type="warn">
**Suscripciones borrador**: No generan facturas hasta ser activadas manualmente en la plataforma o actualizadas vía API.
</Callout>

### Fecha de Inicio Personalizada

Programa suscripciones para facturación futura:

```typescript
const subscription = await commet.subscriptions.create({
  productId: 'prod_monthly_plan',
  customerId: 'cus_A1b2C3d4E5f6G7h8I9j0K1l2',
  startDate: '2025-02-01T00:00:00Z', // Fecha futura
  status: 'active'
})

// Día de facturación establecido a: 1 de febrero
console.log('Día de facturación:', subscription.data.billingDayOfMonth) // 1
```

## Ejemplos Completos

### Plataforma SaaS (Asientos)

```typescript
// Crea suscripción con asientos iniciales
const sub = await commet.subscriptions.create({
  productId: 'prod_saas_platform',
  externalId: 'startup-xyz',
  initialSeats: 5,
  name: 'Startup XYZ - Plan Growth',
  status: 'active'
})

// Usuario agrega miembros del equipo
await commet.seats.add({
  externalId: 'startup-xyz',
  seatType: 'editor',
  count: 3
})

// Verifica balance actual
const balance = await commet.seats.getBalance({
  externalId: 'startup-xyz',
  seatType: 'editor'
})
console.log('Total asientos:', balance.data.current) // 8
```

### Plataforma API (Uso)

```typescript
// Crea suscripción
await commet.subscriptions.create({
  productId: 'prod_api_platform',
  customerId: 'cus_fintech_app'
})

// Rastrea uso de API
await commet.usage.createBatch({
  events: [
    {
      eventType: 'api_call',
      customerId: 'cus_fintech_app',
      properties: [
        { property: 'endpoint', value: '/api/transactions' },
        { property: 'method', value: 'POST' }
      ]
    }
  ]
})
```

### Deal Enterprise (Fijo)

```typescript
// Crea como borrador para revisión de ventas
const draft = await commet.subscriptions.create({
  productId: 'prod_enterprise',
  customerId: 'cus_big_corp',
  quantity: 100,
  name: 'Big Corp - Deal Enterprise Personalizado',
  status: 'draft'
})

// Después de aprobación, activa en la UI de la plataforma
```

## Manejo de Errores

Maneja errores comunes elegantemente:

```typescript
try {
  await commet.subscriptions.create({
    productId: 'prod_xxx',
    customerId: 'cus_xxx'
  })
} catch (error) {
  if (error.statusCode === 404) {
    console.error('Producto o cliente no encontrado')
  } else if (error.statusCode === 400) {
    console.error('Producto no tiene precios de lista configurados')
  }
}
```

## Mejores Prácticas

<Callout type="info">
**Usa IDs Externos**: Conéctate con tu sistema existente para una integración más simple.
</Callout>

<Callout type="info">
**Por defecto Activo**: Usa `status: "active"` a menos que se requiera aprobación manual.
</Callout>

<Callout type="info">
**Auto-configuración**: Deja que el backend maneje los quantity sources - no sobre-pienses la configuración.
</Callout>

<Callout type="info">
**Asientos Empiezan en Cero**: Para productos por asientos, establece `initialSeats: 0` y agrega asientos mientras los usuarios se registran.
</Callout>

## Recursos Relacionados

- [Eventos de Uso](/docs/es/library/features/usage-events) - Rastrea consumo para facturación por uso
- [Gestión de Asientos](/docs/es/library/features/seat-management) - Gestiona licencias por asiento
- [Clientes](/docs/es/library/features/customers) - Crea y gestiona clientes
